<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vignette_eCDF_ePDF • COA34</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Vignette_eCDF_ePDF">
<meta property="og:description" content="COA34">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">COA34</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Vignette_eCDF_ePDF.html">Vignette_eCDF_ePDF</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Vignette_eCDF_ePDF_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Vignette_eCDF_ePDF</h1>
            
      
      
      <div class="hidden name"><code>Vignette_eCDF_ePDF.Rmd</code></div>

    </div>

    
    
<div id="custom-ecdf-and-epdf" class="section level1">
<h1 class="hasAnchor">
<a href="#custom-ecdf-and-epdf" class="anchor"></a>Custom eCDF and ePDF</h1>
<p>Output eCDFs and ePDFs in alignment with FDA Guidance 3.</p>
<p>The plots that appear in the html look bad - they are fine when output to a .png file.</p>
<div id="required-r-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#required-r-packages" class="anchor"></a>Required R packages</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">COA34</span><span class="op">)</span>
<span class="co"># In addition, you'll need the following</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></code></pre></div>
</div>
<div id="generate-data" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-data" class="anchor"></a>Generate data</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">sim.out</span> <span class="op">&lt;-</span> <span class="fu">COA34</span><span class="fu">::</span><span class="fu"><a href="../reference/sim_pro_dat.html">sim_pro_dat</a></span><span class="op">(</span>N<span class="op">=</span><span class="fl">1e3</span>,
                        polychor.value <span class="op">=</span> <span class="fl">0.4</span>,
                        corr <span class="op">=</span> <span class="st">'ar1'</span>,
                        cor.value <span class="op">=</span> <span class="fl">0.8</span>,
                        var.values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>

<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim.out</span><span class="op">$</span><span class="va">dat</span>


<span class="co"># You already have the PGIS_bl and PGIS_delta in the generated data,</span>
<span class="co"># you wouldn't have that in a real dataset, so drop that first</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span>, <span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'PGIS_bl'</span>, <span class="st">'PGIS_delta'</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="co"># This makes the resf of this more realistic</span></code></pre></div>
</div>
<div id="implement-drop-out" class="section level2">
<h2 class="hasAnchor">
<a href="#implement-drop-out" class="anchor"></a>Implement drop-out</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">COA34</span><span class="fu">::</span><span class="fu"><a href="../reference/dropout.html">dropout</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>,
               type_dropout  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mcar'</span>, <span class="st">'mar'</span>, <span class="st">'mnar'</span><span class="op">)</span>,
               prop.miss <span class="op">=</span> <span class="fl">0.5</span>,
               stochastic.component <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code></pre></div>
</div>
<div id="compute-pgis-delta" class="section level2">
<h2 class="hasAnchor">
<a href="#compute-pgis-delta" class="anchor"></a>Compute PGIS delta</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">COA34</span><span class="fu">::</span><span class="fu"><a href="../reference/compute_anchor_delta.html">compute_anchor_delta</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>,
                                   subject.id <span class="op">=</span> <span class="st">'USUBJID'</span>,
                                   time.var <span class="op">=</span> <span class="st">'Time'</span>,
                                   anchor <span class="op">=</span> <span class="st">'PGIS'</span><span class="op">)</span></code></pre></div>
</div>
<div id="compute-pro-score-delta" class="section level2">
<h2 class="hasAnchor">
<a href="#compute-pro-score-delta" class="anchor"></a>Compute PRO Score delta</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">COA34</span><span class="fu">::</span><span class="fu"><a href="../reference/compute_change_score.html">compute_change_score</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>,
                                   subject.id <span class="op">=</span> <span class="st">'USUBJID'</span>,
                                   time.var <span class="op">=</span> <span class="st">'Time'</span>,
                                   score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Y_comp'</span>, <span class="st">'Y_mcar'</span>, <span class="st">'Y_mar'</span>, <span class="st">'Y_mnar'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="compute-anchor-groups" class="section level2">
<h2 class="hasAnchor">
<a href="#compute-anchor-groups" class="anchor"></a>Compute anchor groups</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">COA34</span><span class="fu">::</span><span class="fu"><a href="../reference/compute_anchor_group.html">compute_anchor_group</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>,
                                   anchor.variable <span class="op">=</span> <span class="st">'PGIS_delta'</span>,
                                   number.of.anchor.groups <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
</div>
<div id="compute-thresholds" class="section level2">
<h2 class="hasAnchor">
<a href="#compute-thresholds" class="anchor"></a>Compute Thresholds</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">thr</span> <span class="op">&lt;-</span> <span class="fu">COA34</span><span class="fu">::</span><span class="fu"><a href="../reference/compute_thresholds.html">compute_thresholds</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>,
                                 anchor.group <span class="op">=</span> <span class="st">'anchor.groups'</span>,
                                 time.var <span class="op">=</span> <span class="st">'Time'</span>,
                                 change.score <span class="op">=</span> <span class="st">'Y_comp_delta'</span><span class="op">)</span></code></pre></div>
</div>
<div id="compute-proportion-surpassing-threshold" class="section level2">
<h2 class="hasAnchor">
<a href="#compute-proportion-surpassing-threshold" class="anchor"></a>Compute Proportion Surpassing Threshold</h2>
<p>This function is a little more obscure.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">cap</span> <span class="op">&lt;-</span> <span class="fu">COA34</span><span class="fu">::</span><span class="fu"><a href="../reference/compute_prop_surp.html">compute_prop_surp</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>,
                                anchor.group <span class="op">=</span> <span class="st">'anchor.groups'</span>,
                                time.var <span class="op">=</span> <span class="st">'Time'</span>,
                                change.score <span class="op">=</span> <span class="st">'Y_comp_delta'</span>,
                                threshold.label <span class="op">=</span> <span class="st">'Improved_1'</span>,
                                mean.or.median <span class="op">=</span> <span class="st">'median'</span><span class="op">)</span></code></pre></div>
</div>
<div id="adjusting-naming-of-tablesfigures" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusting-naming-of-tablesfigures" class="anchor"></a>Adjusting Naming of Tables/Figures</h2>
<p>Show how to change out the names of the anchor groups, <code><a href="https://rdrr.io/r/base/table.html">table(dat$anchor.groups)</a></code>. Use the function <code><a href="https://rdrr.io/r/base/grep.html">gsub()</a></code> or <code><a href="https://rdrr.io/r/base/ifelse.html">ifelse()</a></code> statement, using <code>Improved, 2</code></p>
<p><a href="https://stackoverflow.com/questions/60566227/inserting-math-symbols-in-legends-of-r-plots" class="uri">https://stackoverflow.com/questions/60566227/inserting-math-symbols-in-legends-of-r-plots</a> paste0(“Improved  2”)</p>
<p>This does not show up correctly in R Markdown, but will work in the plots.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">anchor.groups</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Improved_2+      Improved_1      Maintained  Deteriorated_1 Deteriorated_2+ </span>
<span class="co">#&gt;             660             506            1714             491             629</span>
<span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">'Improved_2+'</span>, replacement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Improved \u2265 2"</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">anchor.groups</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span>
<span class="co">#&gt; tmp</span>
<span class="co">#&gt;  Deteriorated_1 Deteriorated_2+   Improved = 2+      Improved_1      Maintained </span>
<span class="co">#&gt;             491             629             660             506            1714</span>

<span class="co">#dat$anchor.groups &lt;- gsub(pattern = 'Improved_2+', replacement = paste0("Improved \u2265 2"), x = dat$anchor.groups )</span>

<span class="co">#dat$anchor.groups &lt;- gsub(pattern = 'Deteriorated_2+', replacement = paste0("Deteriorated \u2265 2"), x = dat$anchor.groups )</span></code></pre></div>
</div>
<div id="plot-ecdfs-and-epdfs" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-ecdfs-and-epdfs" class="anchor"></a>Plot eCDFs and ePDFs</h2>
<p>We’re going to do this two ways, first the easy way, with a function that automates it. Then we will go and do it by hand, to give you code to customize.</p>
<p>This way, if the function doesn’t give you exactly what you need, you have something to modify and can quickly get what you need.</p>
<div id="easy-way---use-the-function" class="section level3">
<h3 class="hasAnchor">
<a href="#easy-way---use-the-function" class="anchor"></a>Easy Way - Use the function</h3>
<p>This is the most expedient approach. You can use this if you have 200 eCDF/ePDFs to compute. This function automatically prints out a png file with the eCDF/ePDF together.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplot2_eCDF.html">ggplot2_eCDF</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>,
                    print.to.png <span class="op">=</span> <span class="cn">T</span>,
                    file.name <span class="op">=</span> <span class="st">'Example_eCDF_ePDF_ggplot2'</span>,
                    anchor.group <span class="op">=</span> <span class="st">'anchor.groups'</span>,
                    time.var <span class="op">=</span> <span class="st">'Time'</span>,
                    change.score <span class="op">=</span> <span class="st">'Y_comp_delta'</span><span class="op">)</span>

<span class="co"># Note: you can use the paste0 function to use this in a loop</span>
<span class="co"># update anchor_name in the loop</span>
<span class="co"># file.name = paste0('eCDF_ePDF', anchor_name)</span></code></pre></div>
<p>This also automatically returns you an object with the two ggplot2 plot objects. You can plot them together on the same figure.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplot2_eCDF.html">ggplot2_eCDF</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>,
                    print.to.png <span class="op">=</span> <span class="cn">F</span>,
                    anchor.group <span class="op">=</span> <span class="st">'anchor.groups'</span>,
                    time.var <span class="op">=</span> <span class="st">'Time'</span>,
                    change.score <span class="op">=</span> <span class="st">'Y_comp_delta'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">eCDF</span><span class="op">)</span></code></pre></div>
<p><img src="Vignette_eCDF_ePDF_files/figure-html/plot_funct_2-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">ePDF</span><span class="op">)</span></code></pre></div>
<p><img src="Vignette_eCDF_ePDF_files/figure-html/plot_funct_2-2.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot both:</span>
<span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">eCDF</span>, <span class="va">out</span><span class="op">$</span><span class="va">ePDF</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="Vignette_eCDF_ePDF_files/figure-html/plot_funct_2-3.png" width="700"></p>
<p>There’s an option to return versions suitable for shell tables:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggplot2_eCDF.html">ggplot2_eCDF</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>,
                    shell.table <span class="op">=</span> <span class="cn">T</span>,
                    print.to.png <span class="op">=</span> <span class="cn">F</span>,
                    anchor.group <span class="op">=</span> <span class="st">'anchor.groups'</span>,
                    time.var <span class="op">=</span> <span class="st">'Time'</span>,
                    change.score <span class="op">=</span> <span class="st">'Y_comp_delta'</span><span class="op">)</span>
    
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">eCDF</span><span class="op">)</span></code></pre></div>
<p><img src="Vignette_eCDF_ePDF_files/figure-html/plot_shell-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot(out$ePDF)</span>
<span class="co"># gridExtra::grid.arrange(out$eCDF, out$ePDF, ncol = 1)</span></code></pre></div>
</div>
</div>
<div id="customize-the-ecdf-epdf" class="section level2">
<h2 class="hasAnchor">
<a href="#customize-the-ecdf-epdf" class="anchor"></a>Customize the eCDF &amp; ePDF</h2>
<p>You may want to create a custom plot. There may be one or two scores that are the focus of your report, and for those, you need to make the plots by hand with several customized modifications. In that case, let’s give you a template to use.</p>
<div id="compute-the-density-the-thresholds-and-sample-sizes" class="section level3">
<h3 class="hasAnchor">
<a href="#compute-the-density-the-thresholds-and-sample-sizes" class="anchor"></a>Compute the density, the thresholds, and sample sizes</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R">
  <span class="va">dat.den</span> <span class="op">&lt;-</span> <span class="fu">COA34</span><span class="fu">::</span><span class="fu"><a href="../reference/compute_ecdf.html">compute_ecdf</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>,
                                 anchor.group <span class="op">=</span> <span class="st">'anchor.groups'</span>,
                                 time.var <span class="op">=</span> <span class="st">'Time'</span>,
                                 change.score <span class="op">=</span> <span class="st">'Y_comp_delta'</span><span class="op">)</span>


  <span class="va">thr</span> <span class="op">&lt;-</span> <span class="fu">COA34</span><span class="fu">::</span><span class="fu"><a href="../reference/compute_thresholds.html">compute_thresholds</a></span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>,
                                   anchor.group <span class="op">=</span> <span class="st">'anchor.groups'</span>,
                                   time.var <span class="op">=</span> <span class="st">'Time'</span>,
                                   change.score <span class="op">=</span> <span class="st">'Y_comp_delta'</span><span class="op">)</span>


  <span class="va">plot.legend</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">thr</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Anchor Group'</span>, <span class="st">'N'</span><span class="op">)</span><span class="op">]</span>, <span class="fl">1</span>,
                         <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">' (N = '</span>, <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">')'</span><span class="op">)</span><span class="op">)</span>

    <span class="co"># Shell Tables: plot.legend &lt;- apply(thr[, c('Anchor Group'), drop = F ], 1, function(x) paste0(x, ' (N = xx)'))</span></code></pre></div>
</div>
<div id="create-the-ggplot2-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#create-the-ggplot2-plots" class="anchor"></a>Create the ggplot2 plots</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">
 <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
 <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span>
 <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span>

<span class="co"># eCDF</span>
  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat.den</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">density_x</span>, y<span class="op">=</span><span class="va">CDF</span>, group<span class="op">=</span><span class="va">anchor.groups</span>, color<span class="op">=</span><span class="va">anchor.groups</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> title <span class="op">=</span> <span class="st">'Empirical Cumulative Distribution of Change in Score from Baseline'</span>,
          legend.title <span class="op">=</span> <span class="st">'Anchor Groups'</span>,
          caption <span class="op">=</span> <span class="va">cap</span><span class="op">$</span><span class="va">ecdf.caption</span>,
          x <span class="op">=</span> <span class="st">'Change in score from baseline'</span>,
          y <span class="op">=</span> <span class="st">'Cumulative proportion of patients'</span>,
          color <span class="op">=</span> <span class="st">'Anchor Groups'</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">plot.legend</span>,
                     values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dat.den</span><span class="op">$</span><span class="va">anchor.groups</span><span class="op">)</span><span class="op">)</span>

  <span class="va">p1</span></code></pre></div>
<p><img src="Vignette_eCDF_ePDF_files/figure-html/plot_custom_2-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># ePDF</span>
  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat.den</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">density_x</span>, y<span class="op">=</span><span class="va">density_y</span>, group<span class="op">=</span><span class="va">anchor.groups</span>, color<span class="op">=</span><span class="va">anchor.groups</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> title <span class="op">=</span> <span class="st">'Empirical Density Function of Change in Score from Baseline'</span>,
          x <span class="op">=</span> <span class="st">'Change in score from baseline'</span>,
          y <span class="op">=</span> <span class="st">'Density'</span>,
          color <span class="op">=</span> <span class="st">'Anchor Groups'</span><span class="op">)</span> <span class="op">+</span>
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">plot.legend</span>,
                     values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dat.den</span><span class="op">$</span><span class="va">anchor.groups</span><span class="op">)</span><span class="op">)</span>

    <span class="va">p2</span></code></pre></div>
<p><img src="Vignette_eCDF_ePDF_files/figure-html/plot_custom_2-2.png" width="700"></p>
<p>You can customize this code to yield what you want. Google is your friend here.</p>
</div>
<div id="output" class="section level3">
<h3 class="hasAnchor">
<a href="#output" class="anchor"></a>Output</h3>
<p>After you’re done, it’s easy to push these ggplot2 objects to a file:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R">
  <span class="va">file.name</span> <span class="op">&lt;-</span> <span class="st">'Customized_eCDF'</span>

<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">file.name</span>, <span class="st">'.png'</span><span class="op">)</span>, units<span class="op">=</span><span class="st">"in"</span>, width<span class="op">=</span><span class="fl">11</span>, height<span class="op">=</span><span class="fl">8.5</span>, res<span class="op">=</span><span class="fl">300</span><span class="op">)</span>

  <span class="va">p1</span>

<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">#-------------------------------</span>

  <span class="va">file.name</span> <span class="op">&lt;-</span> <span class="st">'Customized_ePDF'</span>

<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">file.name</span>, <span class="st">'.png'</span><span class="op">)</span>, units<span class="op">=</span><span class="st">"in"</span>, width<span class="op">=</span><span class="fl">11</span>, height<span class="op">=</span><span class="fl">8.5</span>, res<span class="op">=</span><span class="fl">300</span><span class="op">)</span>

  <span class="va">p2</span>

<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
